# Use the official Jekyll image as the base for the build stage
FROM jekyll/jekyll:latest as builder

# Create a new directory for your Jekyll site
RUN mkdir /app

# Change to the new app directory
WORKDIR /app

# Copy your entire Jekyll site into the Docker image
COPY ./path_to_your_jekyll_site /app

# Install any needed packages specified in Gemfile.lock
RUN bundle install

# Build the Jekyll site
RUN jekyll build

# Use NGINX for serving the site in the final stage
FROM nginx:latest

# Copy the static site from the Jekyll build to the NGINX server
COPY --from=builder /app/_site /usr/share/nginx/html

# Expose port 80
EXPOSE 80

# Start NGINX
CMD ["nginx", "-g", "daemon off;"]
